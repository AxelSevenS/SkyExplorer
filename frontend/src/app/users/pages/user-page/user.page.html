<section>
@if (user) {
	<h1>
		@if (authentication.user && authentication.user.id == user.id) {
			Votre Profil
		}
		@else {
			Profil de {{ user.firstName }} {{ user.lastName }}
		}
	</h1>

	<mat-card>
		<form class="grid" id="edit-user__form" [formGroup]="editUserForm">

			<mat-card-content class="grid__container">
				@if (authentication.user && authentication.user.id == user.id) {
					<mat-form-field class="grid__child--full-width">
						<mat-label>E-mail</mat-label>
						<input matInput formControlName="email" type="email" autocomplete="email" placeholder="Adresse E-mail"/>
					</mat-form-field>
				}
				@else {
					<mat-label class="grid__child--label">E-mail</mat-label>
					<span class="grid__child--field">{{ user.email }}</span>
				}

				<mat-label class="grid__child--label">Prénom</mat-label>
				<span class="grid__child--field">{{ user.firstName }}</span>

				<mat-label class="grid__child--label">Nom</mat-label>
				<span class="grid__child--field">{{ user.lastName }}</span>

				@if (authentication.user && (authentication.user.role == UserRoles.Admin || authentication.user.id != user.id)) {
					<mat-form-field class="grid__child--full-width">
						<mat-label>Rôle</mat-label>
						<mat-select matInput formControlName="role">
							@for (role of subRoles; track role) {
								<mat-option [value]="role">{{ UserRoles[role] }}</mat-option>
							}
						</mat-select>
					</mat-form-field>
				}
				@else {
					<mat-label class="grid__child--label">Rôle</mat-label>
					<span class="grid__child--field">{{ user.role }}</span>
				}


				@if (authentication.user && authentication.user.id == user.id) {
					<mat-form-field class="grid__child--half">
						<mat-label>
							Nouveau Mot de Passe
							<mat-icon aria-hidden="false" aria-label="Mot de Passe">lock</mat-icon>
						</mat-label>
						<input matInput formControlName="password" type="password" autocomplete="new-password">
					</mat-form-field>
					<mat-form-field class="grid__child--half">
						<mat-label>
							Confirmer le Nouveau Mot de Passe
							<mat-icon aria-hidden="false" aria-label="Confirmer le Mot de Passe">check</mat-icon>
						</mat-label>
						<input matInput formControlName="passwordConfirm" type="password" autocomplete="new-password">
					</mat-form-field>

					<div class="grid__child--full-width">
						@if (editUserForm.controls['password'].errors != null && editUserForm.controls['password'].value) {
							@if (editUserForm.controls['password'].hasError('PasswordNoUppercase')) {
								<mat-error >Le Mot de Passe doit contenir un <strong>caractère Majuscule</strong></mat-error>
							}
							@if (editUserForm.controls['password'].hasError('PasswordNoLowercase')) {
								<mat-error class="grid__child--full-width">Le Mot de Passe doit contenir un <strong>caractère Minuscule</strong></mat-error>
							}
							@if (editUserForm.controls['password'].hasError('PasswordNoDigit')) {
								<mat-error class="grid__child--full-width">Le Mot de Passe doit contenir un <strong>chiffre</strong></mat-error>
							}
							@if (editUserForm.controls['password'].hasError('PasswordNoSpecial')) {
								<mat-error class="grid__child--full-width">Le Mot de Passe doit contenir un <strong>caractère spécial</strong>.</mat-error>
							}
							@if (editUserForm.controls['password'].hasError('PasswordTooShort')) {
								<mat-error class="grid__child--full-width">Le Mot de Passe doit faire au moins <strong>8</strong> caractères de long.</mat-error>
							}
						}
						@if (editUserForm.controls['password'].errors == null && editUserForm.controls['password'].value && editUserForm.hasError('PasswordNoMatch')) {
							<mat-error class="grid__child--full-width">Les Mots de Passes doivent <strong>correspondrent</strong>.</mat-error>
						}
					</div>
				}

			</mat-card-content>


			@if (authentication.user && (authentication.user.role == UserRoles.Admin || authentication.user.id == user.id)) {
				<mat-card-footer>
					<button class="grid__child--full-width" color="primary" mat-raised-button (click)="onSubmit()">
						Sauvegarder
					</button>
				</mat-card-footer>
			}

		</form>
	</mat-card>
}
</section>